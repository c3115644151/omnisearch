import { computed, ref, watch, nextTick } from "vue";
const useControlledMode = (field, props, emits, options) => {
  const controlledMode = computed(() => props[field] !== void 0);
  const preValue = controlledMode.value ? props[field] : (options == null ? void 0 : options.defaultField) ? props[options.defaultField] : null;
  const innerState = ref((options == null ? void 0 : options.transform) ? options == null ? void 0 : options.transform(preValue) : preValue);
  const updateState = async (nextValue) => {
    if (controlledMode.value) {
      emits(`update:${field}`, nextValue);
      await nextTick();
      innerState.value = (options == null ? void 0 : options.transform) ? options == null ? void 0 : options.transform(props[field]) : props[field];
    } else {
      innerState.value = (options == null ? void 0 : options.transform) ? options == null ? void 0 : options.transform(nextValue) : nextValue;
    }
  };
  watch(
    () => props[field],
    (val) => {
      innerState.value = (options == null ? void 0 : options.transform) ? options == null ? void 0 : options.transform(val) : val;
    }
  );
  return [innerState, updateState, controlledMode];
};
export {
  useControlledMode as u
};
